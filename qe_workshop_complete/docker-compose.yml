# =============================================================================
# Docker Compose for QE Workshop
# =============================================================================
# Usage:
#   Start:  docker compose up        (Docker Compose V2, bundled with Docker Desktop)
#   Stop:   docker compose down
#   Build:  docker compose build
#
# If using legacy docker-compose (V1):
#   Start:  docker-compose up
#   Stop:   docker-compose down
# =============================================================================
version: "3.3"

services:
  qe-workshop:
    image: indranilm/qe-workshop:latest
    container_name: qe-workshop
    ports:
      - "8888:8888"
    volumes:
      - .:/workspace
    environment:
      - ESPRESSO_PSEUDO=/workspace/pseudopotentials
      - OMP_NUM_THREADS=1
      # MPI requires these when running as root inside a container
      - OMPI_ALLOW_RUN_AS_ROOT=1
      - OMPI_ALLOW_RUN_AS_ROOT_CONFIRM=1
    working_dir: /workspace
    command: >
      jupyter lab --ip=0.0.0.0 --port=8888 --no-browser --allow-root
      --NotebookApp.token='' --NotebookApp.password=''
